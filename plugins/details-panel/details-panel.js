window.plugins=window.plugins||{},window.plugins.detailsPanel=class{buttonPanel=null;translations={"en-CA":{detailsPanel:"Details",nothing_found:"Nothing found"},"fr-CA":{detailsPanel:"Détails",nothing_found:"Aucun résultat"}};added=()=>{const{api:e,react:a,makeStyles:t,translate:n}=this,{mapId:l}=this.props,i=this.createElement,{useState:o,useEffect:r,useCallback:s}=a,{useTranslation:c}=n,{language:d}=e.map(l),p=t((e=>({mainContainer:{display:"flex",flexDirection:"row"},layersContainer:{overflow:"hidden",overflowY:"auto",width:"100%"},layerItem:{display:"flex",alignItems:"center",justifyContent:"space-between",margin:"5px 0",padding:"10px 5px",boxSizing:"content-box","&:hover":{cursor:"pointer",backgroundColor:"#c9c9c9"},zIndex:1e3},layerCountTextContainer:{display:"flex",justifyContent:"space-around",alignItems:"center"},layerFeatureCount:{padding:"2px 8px",borderRadius:"50%",backgroundColor:"yellow",color:"black",marginRight:"10px"},layerItemText:{fontSize:"16px",fontWeight:"bold"},layerItemDropdownIcon:{},container:{margin:"0 0 10px 0"},accordion:{backgroundColor:"#eee",color:"#444",cursor:"pointer",padding:"18px",width:"-webkit-fill-available",border:"none",textAlign:"left",outline:"none",fontSize:"15px",transition:"0.4s","&:hover":{backgroundColor:"#ccc"},"&:after":{content:"+",color:"#777",fontWeight:"bold",float:"right",marginLeft:"5px"}},active:{backgroundColor:"#ccc","&:after":{content:"−"}},panel:{padding:"0 18px",backgroundColor:"white",maxHeight:0,overflow:"hidden",transition:"max-height 0.2s ease-out"}}))),u={tooltip:this.translations[d].detailsPanel,icon:'<i class="material-icons">details</i>',visible:!1},y={title:this.translations[d].detailsPanel,icon:'<i class="material-icons">details</i>',content:()=>{const[a,t]=o({}),n=p(),{t:s}=c(),d=e.map(l).map;return r((()=>{const a=e.map(l).layers,n={};a.forEach((e=>{"ogcWMS"!==e.type&&"geoJSON"!==e.type&&(n[e.id]={id:e.id,layer:e.layer,layers:{}},e.layer.query().run(((a,t,l)=>{l.layers.forEach((a=>{const{layers:t}=n[e.id];t[`${a.id}-${a.name.replace(/\s+/g,"-").toLowerCase()}`]={layer:a,layerData:[]},n[e.id].layers=t}))})))})),t(n)}),[]),r((()=>(d.on("click",(e=>{Object.keys(a).forEach((n=>{const l=a[n],{layer:i,layers:o}=l;Object.keys(o).forEach(((l,r)=>{((e,n)=>{const l=a[e],{layers:i}=l;i[n].layerData=[],t((a=>({...a,[e]:{...a[e],layers:i}})))})(n,l),i.identify().on(d).layers(`visible:${r}`).at(e.latlng).run(((e,a,i)=>{e?console.log(e):a.features.length>0&&(o[l].layerData.push(...a.features),t((e=>({...e,[n]:{...e[n],layers:o}}))))}))}))})),this.buttonPanel.panel.open()})),()=>{d.off("click")})),[a,d]),i("div",{className:n.mainContainer},i("div",{className:n.layersContainer},Object.keys(a).map((e=>{const t=a[e];return i("div",{key:t.id},Object.keys(t.layers).map(((e,a)=>{const{layer:l,layerData:o}=t.layers[e];return i("div",{key:a},i("div",{className:n.layerItem,onClick:function(e){e.currentTarget.classList.toggle("active");const a=e.currentTarget.nextElementSibling;a.style.maxHeight?a.style.maxHeight=null:a.style.maxHeight=`${a.scrollHeight}px`}},i("div",{className:n.layerCountTextContainer},i("span",{className:n.layerFeatureCount},o.length),i("div",{className:n.layerItemText,title:l.name},l.name)),i("i",{className:`material-icons ${n.layerItemIcon}`},"arrow_drop_down")),o.length>0?i("div",{className:n.panel},o.map(((e,a)=>{const t=e.properties;return i("div",{key:a,className:n.container},i("button",{className:n.accordion,onClick:e=>{e.currentTarget.classList.toggle("active");const a=e.currentTarget.nextElementSibling;a.style.maxHeight?a.style.maxHeight=null:a.style.maxHeight=`${a.scrollHeight}px`}},t["Project name"]),i("div",{className:n.panel},i("div",{},Object.keys(t).map(((e,a)=>"OBJECTID"!==e&&"Shape"!==e?i("p",{key:a},`${e}: ${t[e]}`):null)))))}))):i("div",{className:n.panel},s("nothing_found")))})))}))))},width:300};this.buttonPanel=e.map(l).createAppbarPanel(u,y,null)};removed=()=>{const{mapId:e}=this.props;this.api.map(e).removeAppbarPanel(this.buttonPanel.id)}};